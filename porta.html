<!-- Agregar este bot√≥n de pesta√±a en la secci√≥n tabs-nav despu√©s del bot√≥n de nutrici√≥n -->
<button class="tab-btn" data-tab="vacunacion">
    <span>üíâ</span>
    <span>Vacunaci√≥n</span>
</button>

<!-- Agregar este contenido de pesta√±a despu√©s del div con id="nutricion" -->
<div class="tab-content" id="vacunacion">
    <div class="form-section">
        <div class="section-header">
            <div class="section-icon">üíâ</div>
            <div class="section-info">
                <h3>Esquema de Vacunaci√≥n</h3>
                <p class="section-description">Control y registro de vacunas aplicadas seg√∫n esquema nacional</p>
            </div>
        </div>

        <!-- Esquema Nacional de Vacunaci√≥n -->
        <div class="form-section">
            <div class="section-header" style="border-bottom: 2px solid #3498db;">
                <div class="section-icon" style="background: linear-gradient(135deg, #3498db, #5dade2);">üìã</div>
                <div class="section-info">
                    <h3 style="color: #3498db;">Esquema Nacional de Vacunaci√≥n</h3>
                    <p class="section-description">Vacunas del esquema b√°sico de inmunizaci√≥n</p>
                </div>
            </div>

            <div class="vacunas-grid">
                <!-- BCG -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ BCG</h4>
                        <span class="enfermedad-badge">Tuberculosis men√≠ngea y miliar</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="bcg" data-dosis="unica">
                            <div class="dosis-info">
                                <span class="dosis-numero">√önica</span>
                                <span class="edad-oportuna">Al nacer</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('bcg', 'unica')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Hepatitis B -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ Hepatitis B</h4>
                        <span class="enfermedad-badge">Hepatitis B</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="hepatitis_b" data-dosis="primera">
                            <div class="dosis-info">
                                <span class="dosis-numero">1era dosis</span>
                                <span class="edad-oportuna">Al nacer</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('hepatitis_b', 'primera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="hepatitis_b" data-dosis="segunda">
                            <div class="dosis-info">
                                <span class="dosis-numero">2da dosis</span>
                                <span class="edad-oportuna">2 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('hepatitis_b', 'segunda')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="hepatitis_b" data-dosis="tercera">
                            <div class="dosis-info">
                                <span class="dosis-numero">3ra dosis</span>
                                <span class="edad-oportuna">6 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('hepatitis_b', 'tercera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pentavalente -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ Pentavalente</h4>
                        <span class="enfermedad-badge">Difteria, Tos ferina, T√©tanos, Hepatitis B, Haemophilus Influenzae tipo B</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="pentavalente" data-dosis="primera">
                            <div class="dosis-info">
                                <span class="dosis-numero">1era dosis</span>
                                <span class="edad-oportuna">2 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('pentavalente', 'primera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="pentavalente" data-dosis="segunda">
                            <div class="dosis-info">
                                <span class="dosis-numero">2da dosis</span>
                                <span class="edad-oportuna">4 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('pentavalente', 'segunda')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="pentavalente" data-dosis="tercera">
                            <div class="dosis-info">
                                <span class="dosis-numero">3ra dosis</span>
                                <span class="edad-oportuna">6 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('pentavalente', 'tercera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="pentavalente" data-dosis="refuerzo">
                            <div class="dosis-info">
                                <span class="dosis-numero">Refuerzo</span>
                                <span class="edad-oportuna">18 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('pentavalente', 'refuerzo')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rotavirus -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ Rotavirus</h4>
                        <span class="enfermedad-badge">Diarrea por Rotavirus</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="rotavirus" data-dosis="primera">
                            <div class="dosis-info">
                                <span class="dosis-numero">1era dosis</span>
                                <span class="edad-oportuna">2 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('rotavirus', 'primera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="rotavirus" data-dosis="segunda">
                            <div class="dosis-info">
                                <span class="dosis-numero">2da dosis</span>
                                <span class="edad-oportuna">4 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('rotavirus', 'segunda')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="rotavirus" data-dosis="tercera">
                            <div class="dosis-info">
                                <span class="dosis-numero">3ra dosis</span>
                                <span class="edad-oportuna">6 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('rotavirus', 'tercera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Neumoc√≥cica conjugada -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ Neumoc√≥cica conjugada</h4>
                        <span class="enfermedad-badge">Enfermedad neumoc√≥cica invasiva</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="neumococica" data-dosis="primera">
                            <div class="dosis-info">
                                <span class="dosis-numero">1era dosis</span>
                                <span class="edad-oportuna">2 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('neumococica', 'primera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="neumococica" data-dosis="segunda">
                            <div class="dosis-info">
                                <span class="dosis-numero">2da dosis</span>
                                <span class="edad-oportuna">4 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('neumococica', 'segunda')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="neumococica" data-dosis="refuerzo">
                            <div class="dosis-info">
                                <span class="dosis-numero">Refuerzo</span>
                                <span class="edad-oportuna">12 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('neumococica', 'refuerzo')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SRP -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ SRP</h4>
                        <span class="enfermedad-badge">Sarampi√≥n, Rub√©ola y Parotiditis</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="srp" data-dosis="primera">
                            <div class="dosis-info">
                                <span class="dosis-numero">1era dosis</span>
                                <span class="edad-oportuna">12 meses</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('srp', 'primera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="srp" data-dosis="segunda">
                            <div class="dosis-info">
                                <span class="dosis-numero">2da dosis</span>
                                <span class="edad-oportuna">6 a√±os</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('srp', 'segunda')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DPT -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ DPT</h4>
                        <span class="enfermedad-badge">Difteria, Tos ferina y T√©tanos</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="dpt" data-dosis="refuerzo">
                            <div class="dosis-info">
                                <span class="dosis-numero">Refuerzo</span>
                                <span class="edad-oportuna">4 a√±os</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('dpt', 'refuerzo')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Virus de Papiloma Humano -->
                <div class="vacuna-card">
                    <div class="vacuna-header">
                        <h4>üíâ Virus de Papiloma Humano</h4>
                        <span class="enfermedad-badge">Infecciones por VPH</span>
                    </div>
                    <div class="dosis-container">
                        <div class="dosis-item" data-vacuna="vph" data-dosis="primera">
                            <div class="dosis-info">
                                <span class="dosis-numero">1era dosis</span>
                                <span class="edad-oportuna">9 a√±os (ni√±as)</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('vph', 'primera')">‚öôÔ∏è</button>
                            </div>
                        </div>
                        <div class="dosis-item" data-vacuna="vph" data-dosis="segunda">
                            <div class="dosis-info">
                                <span class="dosis-numero">2da dosis</span>
                                <span class="edad-oportuna">6 meses despu√©s</span>
                            </div>
                            <div class="fecha-aplicacion">
                                <input type="date" class="fecha-input" placeholder="Fecha de aplicaci√≥n">
                                <button type="button" class="btn-detalles" onclick="abrirDetallesVacuna('vph', 'segunda')">‚öôÔ∏è</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Otras Vacunas -->
        <div class="form-section">
            <div class="section-header" style="border-bottom: 2px solid #9b59b6;">
                <div class="section-icon" style="background: linear-gradient(135deg, #9b59b6, #bb73e0);">‚ûï</div>
                <div class="section-info">
                    <h3 style="color: #9b59b6;">Otras Vacunas</h3>
                    <p class="section-description">Vacunas adicionales y especiales</p>
                </div>
            </div>

            <div class="otras-vacunas-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="otra_vacuna_select" class="form-label">Vacuna <span class="required">*</span></label>
                        <select id="otra_vacuna_select" name="otra_vacuna" class="form-select">
                            <option value="">Selecciona una vacuna...</option>
                            <option value="faboter_anticoral">Faboter√°pico anticoral</option>
                            <option value="faboter_antiloxoceles">Faboter√°pico antiloxoceles</option>
                            <option value="vsr">Vacuna contra el Virus Sincicial Respiratorio (VSR)</option>
                            <option value="herpes_zoster">Vacuna contra el Herpes Zoster</option>
                            <option value="dengue">Vacuna contra el Dengue</option>
                            <option value="meningococo">Vacuna contra el Meningococo</option>
                            <option value="fiebre_amarilla">Vacuna contra la Fiebre amarilla</option>
                            <option value="tdpa">TDPA</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="otra_dosis_select" class="form-label">Dosis <span class="required">*</span></label>
                        <select id="otra_dosis_select" name="otra_dosis" class="form-select">
                            <option value="">Selecciona dosis...</option>
                            <option value="primera">Primera</option>
                            <option value="segunda">Segunda</option>
                            <option value="tercera">Tercera</option>
                            <option value="refuerzo">Refuerzo</option>
                            <option value="adicional">Adicional</option>
                            <option value="unica">√önica</option>
                            <option value="profilactica">Profil√°ctica</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="otra_fecha_vacunacion" class="form-label">Fecha de Vacunaci√≥n <span class="required">*</span></label>
                        <input type="date" id="otra_fecha_vacunacion" name="otra_fecha_vacunacion" class="form-input" required>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <button type="button" class="btn btn-outline" id="agregarOtraVacuna">‚ûï Agregar Vacuna</button>
                </div>

                <!-- Lista de otras vacunas agregadas -->
                <div id="otrasVacunasAgregadas" style="margin-top: 20px;"></div>
            </div>
        </div>

        <!-- Botones de Acci√≥n -->
        <div class="action-buttons">
            <button type="button" class="btn btn-outline" id="limpiarVacunacion">
                <span>üóëÔ∏è</span> Limpiar Formulario
            </button>
            <button type="button" class="btn btn-secondary" id="guardarBorradorVac">
                <span>üíæ</span> Guardar Borrador
            </button>
            <button type="button" class="btn btn-primary" id="guardarVacunacion">
                <span>‚úÖ</span> Guardar Esquema
            </button>
        </div>
    </div>
</div>

<!-- Modal para detalles de vacuna -->
<div class="popup-overlay" id="detallesVacunaModal">
    <div class="popup-content" style="max-width: 800px;">
        <div class="popup-header">
            <h3 class="popup-title" id="tituloDetallesVacuna">Detalles de Vacunaci√≥n</h3>
            <button class="popup-close" onclick="cerrarDetallesVacuna()">√ó</button>
        </div>
        <div class="popup-body">
            <form id="detallesVacunaForm">
                <div class="form-grid">
                    <!-- Rescate -->
                    <div class="form-group">
                        <label class="form-label">Rescate <span class="required">*</span></label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="rescate_si" name="rescate" value="si" class="radio-input">
                                <label for="rescate_si" class="radio-label">S√≠</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="rescate_no" name="rescate" value="no" class="radio-input">
                                <label for="rescate_no" class="radio-label">No</label>
                            </div>
                        </div>
                    </div>

                    <!-- Fecha de Registro -->
                    <div class="form-group">
                        <label for="fecha_registro" class="form-label">Fecha de Registro</label>
                        <input type="date" id="fecha_registro" name="fecha_registro" class="form-input">
                    </div>

                    <!-- Fecha de Aplicaci√≥n -->
                    <div class="form-group">
                        <label for="fecha_aplicacion_detalle" class="form-label">Fecha de Aplicaci√≥n</label>
                        <input type="date" id="fecha_aplicacion_detalle" name="fecha_aplicacion_detalle" class="form-input">
                    </div>

                    <!-- Grupo de Riesgo -->
                    <div class="form-group">
                        <label for="grupo_riesgo" class="form-label">Grupo de Riesgo</label>
                        <select id="grupo_riesgo" name="grupo_riesgo" class="form-select">
                            <option value="">Selecciona...</option>
                            <option value="ninguno">Ninguno</option>
                            <option value="inmunocompromiso">Inmunocompromiso</option>
                            <option value="enfermedad_cronica">Enfermedad cr√≥nica</option>
                            <option value="contacto_tb">Contacto TB</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>

                    <!-- Lote -->
                    <div class="form-group">
                        <label for="lote" class="form-label">Lote</label>
                        <input type="text" id="lote" name="lote" class="form-input" placeholder="N√∫mero de lote">
                    </div>

                    <!-- Fecha de Caducidad -->
                    <div class="form-group">
                        <label for="fecha_caducidad" class="form-label">Fecha de Caducidad</label>
                        <input type="date" id="fecha_caducidad" name="fecha_caducidad" class="form-input">
                    </div>

                    <!-- Lugar de Aplicaci√≥n -->
                    <div class="form-group">
                        <label class="form-label">Lugar de Aplicaci√≥n</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="intramuros" name="lugar_aplicacion" value="intramuros" class="radio-input">
                                <label for="intramuros" class="radio-label">Intramuros</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="extramuros" name="lugar_aplicacion" value="extramuros" class="radio-input">
                                <label for="extramuros" class="radio-label">Extramuros</label>
                            </div>
                        </div>
                    </div>

                    <!-- Reacciones Adversas -->
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label class="form-label">¬øPresent√≥ reacciones adversas?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="reacciones_si" name="reacciones_adversas" value="si" class="radio-input">
                                <label for="reacciones_si" class="radio-label">S√≠</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="reacciones_no" name="reacciones_adversas" value="no" class="radio-input">
                                <label for="reacciones_no" class="radio-label">No</label>
                            </div>
                        </div>
                    </div>

                    <!-- Molestias -->
                    <div class="form-group" id="molestias_section" style="grid-column: 1 / -1; display: none;">
                        <label class="form-label">Seleccione las molestias:</label>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" id="cefalea" name="molestias[]" value="cefalea" class="checkbox-input">
                                <label for="cefalea" class="checkbox-label">Cefalea</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="fiebre" name="molestias[]" value="fiebre" class="checkbox-input">
                                <label for="fiebre" class="checkbox-label">Fiebre</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dolor_sitio" name="molestias[]" value="dolor_sitio" class="checkbox-input">
                                <label for="dolor_sitio" class="checkbox-label">Dolor en el sitio de aplicaci√≥n</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="malestar_general" name="molestias[]" value="malestar_general" class="checkbox-input">
                                <label for="malestar_general" class="checkbox-label">Malestar general</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="escalofrio" name="molestias[]" value="escalofrio" class="checkbox-input">
                                <label for="escalofrio" class="checkbox-label">Escalofr√≠o</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cansancio" name="molestias[]" value="cansancio" class="checkbox-input">
                                <label for="cansancio" class="checkbox-label">Cansancio</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="inflamacion" name="molestias[]" value="inflamacion" class="checkbox-input">
                                <label for="inflamacion" class="checkbox-label">Inflamaci√≥n o enrojecimiento en el sitio</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="dolor_muscular" name="molestias[]" value="dolor_muscular" class="checkbox-input">
                                <label for="dolor_muscular" class="checkbox-label">Dolor muscular y articular</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="otra_molestia" name="molestias[]" value="otra" class="checkbox-input">
                                <label for="otra_molestia" class="checkbox-label">Otra</label>
                            </div>
                        </div>
                        
                        <!-- Campo para especificar "otra" molestia -->
                        <div id="otra_molestia_detalle" style="display: none; margin-top: 10px;">
                            <input type="text" id="otra_molestia_texto" name="otra_molestia_texto" class="form-input" placeholder="Especifique la molestia">
                        </div>
                    </div>
                </div>

                <div class="action-buttons" style="margin-top: 30px;">
                    <button type="button" class="btn btn-secondary" onclick="cerrarDetallesVacuna()">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarDetallesVacuna()">Guardar Detalles</button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
/* Estilos espec√≠ficos para vacunaci√≥n */
.vacunas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.vacuna-card {
    background: white;
    border: 2px solid #e9ecef;
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
}

.vacuna-card:hover {
    border-color: #3498db;
    box-shadow: 0 4px 15px rgba(52, 152, 219, 0.1);
}

.vacuna-header {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    padding: 15px 20px;
    border-bottom: 2px solid #dee2e6;
}

.vacuna-header h4 {
    margin: 0 0 8px 0;
    color: #2c3e50;
    font-size: 18px;
    font-weight: bold;
}

.enfermedad-badge {
    background: #3498db;
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
}

.dosis-container {
    padding: 15px 20px;
}

.dosis-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #f1f1f1;
    transition: all 0.3s ease;
}

.dosis-item:last-child {
    border-bottom: none;
}

.dosis-item:hover {
    background: #f8f9fa;
    border-radius: 8px;
    padding-left: 10px;
    padding-right: 10px;
}

.dosis-info {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.dosis-numero {
    font-weight: bold;
    color: #2c3e50;
    font-size: 14px;
}

.edad-oportuna {
    color: #7f8c8d;
    font-size: 12px;
    font-style: italic;
}

.fecha-aplicacion {
    display: flex;
    align-items: center;
    gap: 10px;
}

.fecha-input {
    padding: 6px 10px;
    border: 2px solid #dee2e6;
    border-radius: 6px;
    font-size: 13px;
    width: 140px;
    transition: all 0.3s ease;
}

.fecha-input:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.1);
}

.fecha-input.completada {
    background: #d4edda;
    border-color: #28a745;
}

.btn-detalles {
    background: #6c757d;
    color: white;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn-detalles:hover {
    background: #5a6268;
    transform: scale(1.1);
}

.btn-detalles.completado {
    background: #28a745;
}

.btn-detalles.completado:hover {
    background: #218838;
}

.otras-vacunas-form {
    background: white;
    border-radius: 12px;
    padding: 25px;
    border: 2px solid #e9ecef;
}

.vacuna-agregada {
    background: #f8f9fa;
    border: 2px solid #28a745;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.vacuna-agregada-info {
    flex: 1;
}

.vacuna-agregada-titulo {
    font-weight: bold;
    color: #2c3e50;
    margin-bottom: 5px;
}

.vacuna-agregada-detalles {
    font-size: 14px;
    color: #6c757d;
}

.btn-eliminar-vacuna {
    background: #e74c3c;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 6px 12px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.3s ease;
}

.btn-eliminar-vacuna:hover {
    background: #c0392b;
    transform: scale(1.05);
}

/* Estilos para molestias en el modal */
#molestias_section .checkbox-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    margin-top: 10px;
}

#molestias_section .checkbox-item {
    padding: 8px 12px;
    font-size: 14px;
}

/* Indicador de vacuna completada */
.dosis-item.completada {
    background: linear-gradient(135deg, #d4edda, #c3e6cb);
    border-radius: 8px;
    padding-left: 10px;
    padding-right: 10px;
}

.dosis-item.completada .dosis-numero {
    color: #155724;
}

.dosis-item.completada .edad-oportuna {
    color: #155724;
}

/* Responsive */
@media (max-width: 768px) {
    .vacunas-grid {
        grid-template-columns: 1fr;
    }
    
    .dosis-item {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
    }
    
    .fecha-aplicacion {
        justify-content: space-between;
    }
    
    .fecha-input {
        width: auto;
        flex: 1;
    }
}
</style>

<script>
// Variables globales para el modal de detalles
let vacunaActual = '';
let dosisActual = '';

// Funci√≥n para abrir detalles de vacuna
function abrirDetallesVacuna(vacuna, dosis) {
    vacunaActual = vacuna;
    dosisActual = dosis;
    
    // Configurar t√≠tulo del modal
    const nombreVacuna = document.querySelector(`[data-vacuna="${vacuna}"][data-dosis="${dosis}"]`)
        .closest('.vacuna-card').querySelector('h4').textContent;
    document.getElementById('tituloDetallesVacuna').textContent = `${nombreVacuna} - ${dosis}`;
    
    // Copiar fecha si ya existe
    const fechaExistente = document.querySelector(`[data-vacuna="${vacuna}"][data-dosis="${dosis}"] .fecha-input`).value;
    if (fechaExistente) {
        document.getElementById('fecha_aplicacion_detalle').value = fechaExistente;
    }
    
    // Mostrar modal
    document.getElementById('detallesVacunaModal').style.display = 'flex';
}

// Funci√≥n para cerrar detalles de vacuna
function cerrarDetallesVacuna() {
    document.getElementById('detallesVacunaModal').style.display = 'none';
    limpiarFormularioDetalles();
}

// Funci√≥n para limpiar formulario de detalles
function limpiarFormularioDetalles() {
    document.getElementById('detallesVacunaForm').reset();
    document.getElementById('molestias_section').style.display = 'none';
    document.getElementById('otra_molestia_detalle').style.display = 'none';
    
    // Limpiar checkboxes
    document.querySelectorAll('#molestias_section .checkbox-item').forEach(item => {
        item.classList.remove('checked');
    });
}

// Funci√≥n para guardar detalles de vacuna
function guardarDetallesVacuna() {
    const fechaAplicacion = document.getElementById('fecha_aplicacion_detalle').value;
    const rescate = document.querySelector('input[name="rescate"]:checked')?.value;
    
    if (!fechaAplicacion) {
        alert('La fecha de aplicaci√≥n es obligatoria');
        return;
    }
    
    if (!rescate) {
        alert('Debe indicar si es rescate o no');
        return;
    }
    
    // Actualizar fecha en la tarjeta principal
    const dosisElement = document.querySelector(`[data-vacuna="${vacunaActual}"][data-dosis="${dosisActual}"]`);
    const fechaInput = dosisElement.querySelector('.fecha-input');
    const btnDetalles = dosisElement.querySelector('.btn-detalles');
    
    fechaInput.value = fechaAplicacion;
    fechaInput.classList.add('completada');
    btnDetalles.classList.add('completado');
    dosisElement.classList.add('completada');
    
    // Guardar datos de la vacuna (aqu√≠ puedes implementar el almacenamiento)
    const datosVacuna = {
        vacuna: vacunaActual,
        dosis: dosisActual,
        fechaAplicacion: fechaAplicacion,
        rescate: rescate,
        fechaRegistro: document.getElementById('fecha_registro').value,
        grupoRiesgo: document.getElementById('grupo_riesgo').value,
        lote: document.getElementById('lote').value,
        fechaCaducidad: document.getElementById('fecha_caducidad').value,
        lugarAplicacion: document.querySelector('input[name="lugar_aplicacion"]:checked')?.value,
        reaccionesAdversas: document.querySelector('input[name="reacciones_adversas"]:checked')?.value,
        molestias: Array.from(document.querySelectorAll('input[name="molestias[]"]:checked')).map(cb => cb.value),
        otraMolestia: document.getElementById('otra_molestia_texto').value
    };
    
    console.log('Datos de vacuna guardados:', datosVacuna);
    
    alert('Detalles de vacuna guardados correctamente');
    cerrarDetallesVacuna();
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Mostrar/ocultar secci√≥n de molestias
    document.querySelectorAll('input[name="reacciones_adversas"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const molestiaSection = document.getElementById('molestias_section');
            if (this.value === 'si') {
                molestiaSection.style.display = 'block';
            } else {
                molestiaSection.style.display = 'none';
                // Limpiar molestias seleccionadas
                document.querySelectorAll('input[name="molestias[]"]').forEach(cb => {
                    cb.checked = false;
                });
                document.getElementById('otra_molestia_detalle').style.display = 'none';
            }
        });
    });
    
    // Mostrar/ocultar campo "otra molestia"
    document.getElementById('otra_molestia').addEventListener('change', function() {
        const otraDetalle = document.getElementById('otra_molestia_detalle');
        if (this.checked) {
            otraDetalle.style.display = 'block';
        } else {
            otraDetalle.style.display = 'none';
            document.getElementById('otra_molestia_texto').value = '';
        }
    });
    
    // Funcionalidad para checkboxes de molestias
    document.querySelectorAll('#molestias_section .checkbox-item').forEach(item => {
        const checkbox = item.querySelector('.checkbox-input');
        if (checkbox) {
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    item.classList.add('checked');
                } else {
                    item.classList.remove('checked');
                }
            });
        }
    });
    
    // Agregar otra vacuna
    document.getElementById('agregarOtraVacuna')?.addEventListener('click', function() {
        const vacunaSelect = document.getElementById('otra_vacuna_select');
        const dosisSelect = document.getElementById('otra_dosis_select');
        const fechaInput = document.getElementById('otra_fecha_vacunacion');
        
        if (!vacunaSelect.value || !dosisSelect.value || !fechaInput.value) {
            alert('Por favor complete todos los campos para agregar la vacuna');
            return;
        }
        
        const vacunaTexto = vacunaSelect.options[vacunaSelect.selectedIndex].text;
        const dosisTexto = dosisSelect.options[dosisSelect.selectedIndex].text;
        const fecha = fechaInput.value;
        
        agregarOtraVacunaALista(vacunaTexto, dosisTexto, fecha);
        
        // Limpiar campos
        vacunaSelect.value = '';
        dosisSelect.value = '';
        fechaInput.value = '';
    });
    
    // Cerrar modal al hacer clic fuera
    document.getElementById('detallesVacunaModal').addEventListener('click', function(e) {
        if (e.target === this) {
            cerrarDetallesVacuna();
        }
    });
    
    // Bot√≥n limpiar
    document.getElementById('limpiarVacunacion')?.addEventListener('click', function() {
        if (confirm('¬øEst√° seguro de que desea limpiar todos los datos de vacunaci√≥n?')) {
            // Limpiar fechas de vacunas del esquema
            document.querySelectorAll('.fecha-input').forEach(input => {
                input.value = '';
                input.classList.remove('completada');
            });
            
            // Limpiar estados visuales
            document.querySelectorAll('.dosis-item').forEach(item => {
                item.classList.remove('completada');
            });
            
            document.querySelectorAll('.btn-detalles').forEach(btn => {
                btn.classList.remove('completado');
            });
            
            // Limpiar otras vacunas
            document.getElementById('otrasVacunasAgregadas').innerHTML = '';
            document.getElementById('otra_vacuna_select').value = '';
            document.getElementById('otra_dosis_select').value = '';
            document.getElementById('otra_fecha_vacunacion').value = '';
        }
    });
    
    // Bot√≥n guardar
    document.getElementById('guardarVacunacion')?.addEventListener('click', function() {
        // Recopilar datos de vacunaci√≥n
        const vacunasCompletadas = [];
        
        document.querySelectorAll('.dosis-item.completada').forEach(item => {
            const vacuna = item.dataset.vacuna;
            const dosis = item.dataset.dosis;
            const fecha = item.querySelector('.fecha-input').value;
            
            vacunasCompletadas.push({
                vacuna: vacuna,
                dosis: dosis,
                fecha: fecha
            });
        });
        
        console.log('Esquema de vacunaci√≥n:', vacunasCompletadas);
        alert(`Esquema de vacunaci√≥n guardado. ${vacunasCompletadas.length} vacuna(s) registrada(s).`);
    });
    
    // Bot√≥n borrador
    document.getElementById('guardarBorradorVac')?.addEventListener('click', function() {
        alert('Borrador de esquema de vacunaci√≥n guardado');
    });
});

// Funci√≥n para agregar otra vacuna a la lista
function agregarOtraVacunaALista(vacuna, dosis, fecha) {
    const container = document.getElementById('otrasVacunasAgregadas');
    
    const vacunaItem = document.createElement('div');
    vacunaItem.classList.add('vacuna-agregada');
    vacunaItem.innerHTML = `
        <div class="vacuna-agregada-info">
            <div class="vacuna-agregada-titulo">üíâ ${vacuna}</div>
            <div class="vacuna-agregada-detalles">
                <strong>Dosis:</strong> ${dosis} ‚Ä¢ <strong>Fecha:</strong> ${fecha}
            </div>
        </div>
        <button type="button" class="btn-eliminar-vacuna" onclick="eliminarOtraVacuna(this)">
            üóëÔ∏è Eliminar
        </button>
    `;
    
    container.appendChild(vacunaItem);
}

// Funci√≥n para eliminar otra vacuna
function eliminarOtraVacuna(button) {
    if (confirm('¬øEst√° seguro de eliminar esta vacuna?')) {
        button.parentElement.remove();
    }
}
</script>